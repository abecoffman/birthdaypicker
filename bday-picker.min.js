/*!
 * jQuery Birthday Picker: v1.4 - 10/16/2011
 * http://abecoffman.com/stuff/birthdaypicker
 *
 * Copyright (c) 2010 Abe Coffman
 * Dual licensed under the MIT and GPL licenses.
 *
 */
(function(f){var a={"short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"long":["January","February","March","April","May","June","July","August","September","October","November","December"]},b=new Date(),c=b.getFullYear(),e=b.getMonth()+1,d=b.getDate();f.fn.birthdaypicker=function(g){var i={maxAge:120,minAge:0,futureDates:false,maxYear:c,dateFormat:"middleEndian",monthFormat:"short",placeholder:true,legend:"",defaultDate:false,fieldName:"birthdate",fieldId:"birthdate",hiddenDate:true,onChange:null,tabindex:null};function h(j){return true==j||false==j}return this.each(function(){if(g){f.extend(i,g)}var y=f("<fieldset class='birthday-picker'></fieldset>"),w=f("<select class='birth-year' name='birth[year]'></select>"),v=f("<select class='birth-month' name='birth[month]'></select>"),p=f("<select class='birth-day' name='birth[day]'></select>");if(i.legend){f("<legend>"+i.legend+"</legend>").appendTo(y)}var s=i.tabindex;if(i.dateFormat=="bigEndian"){y.append(w).append(v).append(p);if(s!=null){w.attr("tabindex",s);v.attr("tabindex",s++);p.attr("tabindex",s++)}}else{if(i.dateFormat=="littleEndian"){y.append(p).append(v).append(w);if(s!=null){p.attr("tabindex",s);v.attr("tabindex",s++);w.attr("tabindex",s++)}}else{y.append(v).append(p).append(w);if(s!=null){v.attr("tabindex",s);p.attr("tabindex",s++);w.attr("tabindex",s++)}}}if(i.placeholder){f("<option value='0'>Year:</option>").appendTo(w);f("<option value='0'>Month:</option>").appendTo(v);f("<option value='0'>Day:</option>").appendTo(p)}var q;if(i.defaultDate){var z=null;if(h(i.defaultDate)&&!h(i.hiddenDate)){z=new Date(f("#"+i.hiddenDate).val())}else{if(!h(i.defaultDate)){z=new Date(i.defaultDate)}}if(z!=null){var o=z.getFullYear(),u=z.getMonth()+1,l=z.getDate();q=o+"/"+u+"/"+l}}if(i.hiddenDate&&h(i.hiddenDate)){f("<input type='hidden' name='"+i.fieldName+"'/>").attr("id",i.fieldId).val(q).appendTo(y)}var x=c-i.minAge;var A=c-i.maxAge;if(i.futureDates&&i.maxYear!=c){if(i.maxYear>1000){x=i.maxYear}else{x=c+i.maxYear}}for(var t=x;t>=A;t--){f("<option></option>").attr("value",t).text(t).appendTo(w)}for(var r=0;r<12;r++){f("<option></option>").attr("value",r+1).text(a[i.monthFormat][r]).appendTo(v)}for(var n=1;n<32;n++){f("<option></option>").attr("value",n).text(n).appendTo(p)}f(this).append(y);if(i.defaultDate){var m=new Date(q);w.val(m.getFullYear());v.val(m.getMonth()+1);p.val(m.getDate())}y.change(function(){var D=new Date(),H=D.getFullYear(),F=D.getMonth()+1,G=D.getDate(),I=parseInt(w.val(),10),B=parseInt(v.val(),10),k=parseInt(p.val(),10),E=(new Date(I,B,0)).getDate(),C=parseInt(v.children(":last").val()),j=parseInt(p.children(":last").val());if(j>E){while(j>E){p.children(":last").remove();j--}}else{if(j<E){while(j<E){j++;p.append("<option value="+j+">"+j+"</option>")}}}if(!i.futureDates&&I==x){if(C>F){while(C>F){v.children(":last").remove();C--}p.children(":first").attr("selected","selected")}if(B===F){while(j>G){p.children(":last").remove();j-=1}}}if(I!=x&&C!=12){while(C<12){v.append("<option value="+(C+1)+">"+a[i.monthFormat][C]+"</option>");C++}}if(i.hiddenDate){if((I*B*k)!=0){q=I+"/"+B+"/"+k;if(!h(i.hiddenDate)){f("input#"+i.hiddenDate).val(q)}else{f(this).find("#"+i.fieldId).val(q)}if(i.onChange!=null){i.onChange(q)}}}})})}})(jQuery);