/*
 * jQuery Birthday Picker: v1.4 - 10/16/2011
 * http://abecoffman.com/stuff/birthdaypicker
 *
 * Copyright (c) 2010 Abe Coffman
 * Dual licensed under the MIT and GPL licenses.
 *
 */
(function(e){var t={"short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"long":["January","February","March","April","May","June","July","August","September","October","November","December"]},n=new Date,r=n.getFullYear(),i=n.getMonth()+1,s=n.getDate();e.fn.birthdaypicker=function(n){var i={maxAge:120,minAge:0,futureDates:false,maxYear:r,dateFormat:"middleEndian",monthFormat:"short",placeholder:true,legend:"",defaultDate:false,fieldName:"birthdte",fieldId:"birthdte",hiddenDate:true,onChange:null,tabindex:null,triggerEvent:"change"};return this.each(function(){function S(){if(i["hiddenDate"]){if(!e("#"+i["fieldId"]).length)e("<input type='hidden' name='"+i["fieldName"]+"'/>").attr("id",i["fieldId"]).val(c).appendTo(o)}}if(n){e.extend(i,n)}var s=e("<fieldset class='birthday-picker'></fieldset>"),o=e(this),u=e("<select class='"+i["fieldName"]+"-year' name='"+i["fieldName"]+"[year]'></select>"),a=e("<select class='"+i["fieldName"]+"-month' name='"+i["fieldName"]+"[month]'></select>"),f=e("<select class='"+i["fieldName"]+"-day' name='"+i["fieldName"]+"[day]'></select>");if(i["legend"]){e("<legend>"+i["legend"]+"</legend>").appendTo(s)}var l=i["tabindex"];if(i["dateFormat"]=="bigEndian"){s.append(u).append(a).append(f);if(l!=null){u.attr("tabindex",l);a.attr("tabindex",l++);f.attr("tabindex",l++)}}else if(i["dateFormat"]=="littleEndian"){s.append(f).append(a).append(u);if(l!=null){f.attr("tabindex",l);a.attr("tabindex",l++);u.attr("tabindex",l++)}}else{s.append(a).append(f).append(u);if(l!=null){a.attr("tabindex",l);f.attr("tabindex",l++);u.attr("tabindex",l++)}}if(i["placeholder"]){e("<option value='0'>Year:</option>").appendTo(u);e("<option value='0'>Month:</option>").appendTo(a);e("<option value='0'>Day:</option>").appendTo(f)}var c;if(i["defaultDate"]){var h=new Date(i["defaultDate"]+"T00:00:00"),p=h.getFullYear(),d=h.getMonth()+1,v=h.getDate();if(d<10)d="0"+d;if(v<10)v="0"+v;c=p+"-"+d+"-"+v}var m=r-i["minAge"];var g=r-i["maxAge"];if(i["futureDates"]&&i["maxYear"]!=r){if(i["maxYear"]>1e3){m=i["maxYear"]}else{m=r+i["maxYear"]}}for(var y=m;y>=g;y--){e("<option></option>").attr("value",y).text(y).appendTo(u)}for(var b=0;b<12;b++){e("<option></option>").attr("value",b+1).text(t[i["monthFormat"]][b]).appendTo(a)}for(var w=1;w<32;w++){e("<option></option>").attr("value",w).text(w).appendTo(f)}e(this).append(s);S();if(i["defaultDate"]){var E=new Date(i["defaultDate"]+"T00:00:00");u.val(E.getFullYear());a.val(E.getMonth()+1);f.val(E.getDate())}s.change(function(){var n=new Date,r=n.getFullYear(),s=n.getMonth()+1,o=n.getDate(),l=parseInt(u.val(),10),h=parseInt(a.val(),10),p=parseInt(f.val(),10),d=(new Date(l,h,0)).getDate(),v=parseInt(a.children(":last").val()),g=parseInt(f.children(":last").val());if(g>d){while(g>d){f.children(":last").remove();g--}}else if(g<d){while(g<d){g++;f.append("<option value="+g+">"+g+"</option>")}}if(!i["futureDates"]&&l==m){if(v>s){while(v>s){a.children(":last").remove();v--}f.children(":first").attr("selected","selected")}if(h===s){while(g>o){f.children(":last").remove();g-=1}}}if(l!=m&&v!=12){while(v<12){a.append("<option value="+(v+1)+">"+t[i["monthFormat"]][v]+"</option>");v++}}if(l*h*p!=0){if(h<10)h="0"+h;if(p<10)p="0"+p;c=l+"-"+h+"-"+p;e(this).parent().find("#"+i["fieldId"]).val(c).trigger(i["triggerEvent"]);if(i["onChange"]!=null){i["onChange"](c)}}return false})})}})(jQuery)
