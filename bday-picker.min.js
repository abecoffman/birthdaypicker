/*
 * jQuery Birthday Picker: v1.4 - 10/16/2011
 * http://abecoffman.com/stuff/birthdaypicker
 *
 * Copyright (c) 2010 Abe Coffman
 * Dual licensed under the MIT and GPL licenses.
 *
 */
(function(c){var t={"short":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"long":"January February March April May June July August September October November December".split(" ")},k=new Date,l=k.getFullYear();k.getMonth();k.getDate();c.fn.birthdaypicker=function(k){var b={maxAge:120,minAge:0,futureDates:!1,maxYear:l,dateFormat:"middleEndian",monthFormat:"short",placeholder:!0,legend:"",defaultDate:!1,fieldName:"birthdate",fieldId:"birthdate",hiddenDate:!0,onChange:null,tabindex:null,
ariaDesc:null,ariaLabel:null};return this.each(function(){k&&c.extend(b,k);var a=b.ariaDesc?" aria-describedby='"+b.ariaDesc+"'":"",d=c("<fieldset class='birthday-picker'></fieldset>"),m=c("<select class='birth-year' name='birth_year'"+a+(b.ariaLabel?" aria-label='birth year'":"")+"></select>"),g=c("<select class='birth-month' name='birth_month'"+a+(b.ariaLabel?" aria-label='birth month'":"")+"></select>"),e=c("<select class='birth-day' name='birth_day'"+a+(b.ariaLabel?" aria-label='birthday'":"")+
"></select>");b.legend&&c("<legend>"+b.legend+"</legend>").appendTo(d);a=b.tabindex;"bigEndian"==b.dateFormat?(d.append(m).append(g).append(e),null!=a&&(m.attr("tabindex",a),g.attr("tabindex",a++),e.attr("tabindex",a++))):"littleEndian"==b.dateFormat?(d.append(e).append(g).append(m),null!=a&&(e.attr("tabindex",a),g.attr("tabindex",a++),m.attr("tabindex",a++))):(d.append(g).append(e).append(m),null!=a&&(g.attr("tabindex",a),e.attr("tabindex",a++),m.attr("tabindex",a++)));b.placeholder&&(c("<option value='0'>Year:</option>").appendTo(m),
c("<option value='0'>Month:</option>").appendTo(g),c("<option value='0'>Day:</option>").appendTo(e));var q;if(b.defaultDate){var f=new Date(b.defaultDate+"T00:00:00"),a=f.getFullYear(),h=f.getMonth()+1,f=f.getDate();10>h&&(h="0"+h);10>f&&(f="0"+f);q=a+"-"+h+"-"+f}b.hiddenDate&&c("<input type='hidden' name='"+b.fieldName+"'/>").attr("id",b.fieldId).val(q).appendTo(d);var r=l-b.minAge,a=l-b.maxAge;b.futureDates&&b.maxYear!=l&&(r=1E3<b.maxYear?b.maxYear:l+b.maxYear);for(h=r;h>=a;h--)c("<option></option>").attr("value",
h).text(h).appendTo(m);for(a=0;12>a;a++)c("<option></option>").attr("value",a+1).text(t[b.monthFormat][a]).appendTo(g);for(a=1;32>a;a++)c("<option></option>").attr("value",a).text(a).appendTo(e);c(this).append(d);b.defaultDate&&(a=new Date(b.defaultDate+"T00:00:00"),m.val(a.getFullYear()),g.val(a.getMonth()+1),e.val(a.getDate()));d.change(function(){var a=new Date;a.getFullYear();var h=a.getMonth()+1,a=a.getDate(),f=parseInt(m.val(),10),d=parseInt(g.val(),10),k=parseInt(e.val(),10),l=(new Date(f,
d,0)).getDate(),p=parseInt(g.children(":last").val()),n=parseInt(e.children(":last").val());if(n>l)for(;n>l;)e.children(":last").remove(),n--;else if(n<l)for(;n<l;)n++,e.append("<option value="+n+">"+n+"</option>");if(!b.futureDates&&f==r){if(p>h){for(;p>h;)g.children(":last").remove(),p--;e.children(":first").attr("selected","selected")}if(d===h)for(;n>a;)e.children(":last").remove(),--n}if(f!=r&&12!=p)for(;12>p;)g.append("<option value="+(p+1)+">"+t[b.monthFormat][p]+"</option>"),p++;if(0!=f*d*
k&&(10>d&&(d="0"+d),10>k&&(k="0"+k),q=f+"-"+d+"-"+k,c(this).find("#"+b.fieldId).val(q),null!=b.onChange))b.onChange(q)})})}})(jQuery);